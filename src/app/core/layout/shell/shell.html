<mat-sidenav-container class="layout">
  <mat-sidenav class="sidenav" mode="side" opened>
    <div class="brand">
      <div class="brand-title">POS Jarabe</div>
      <div class="brand-sub">Minimal</div>
    </div>

    <mat-nav-list>
      <button mat-list-item type="button" (click)="go('/app/dashboard')">
        <mat-icon matListItemIcon>dashboard</mat-icon>
        <span matListItemTitle>Dashboard</span>
      </button>

      <button mat-list-item type="button" (click)="go('/app/products')">
        <mat-icon matListItemIcon>inventory_2</mat-icon>
        <span matListItemTitle>Productos</span>
      </button>

      <button mat-list-item type="button" (click)="go('/app/sales')">
        <mat-icon matListItemIcon>point_of_sale</mat-icon>
        <span matListItemTitle>Ventas</span>
      </button>

      <button
        mat-list-item
        type="button"
        (click)="go('/app/reports')"
        *ngIf="perm.can('reports.view')"
      >
        <mat-icon matListItemIcon>bar_chart</mat-icon>
        <span matListItemTitle>Reportes</span>
      </button>

      <button
        mat-list-item
        type="button"
        (click)="go('/app/chat')"
        *ngIf="perm.can('chat.view')"
      >
        <mat-icon matListItemIcon>chat</mat-icon>
        <span matListItemTitle>Chat</span>
      </button>

      <div class="divider" *ngIf="perm.can('users.view') || perm.can('franchises.view')"></div>

      <button
        mat-list-item
        type="button"
        (click)="go('/app/users')"
        *ngIf="perm.can('users.view')"
      >
        <mat-icon matListItemIcon>group</mat-icon>
        <span matListItemTitle>Usuarios</span>
      </button>

      <button
        mat-list-item
        type="button"
        (click)="go('/app/franchises')"
        *ngIf="perm.can('franchises.view')"
      >
        <mat-icon matListItemIcon>store</mat-icon>
        <span matListItemTitle>Franquicias</span>
      </button>


      <button
        mat-list-item
        type="button"
        (click)="go('/app/global-users')"
        *ngIf="isSuper()"
      >
        <mat-icon matListItemIcon>groups</mat-icon>
        <span matListItemTitle>Ver usuarios globales</span>
      </button>







    </mat-nav-list>
  </mat-sidenav>

  <mat-sidenav-content class="content">
    <div class="topbar">
      <div class="spacer"></div>

      <!-- âœ… Selector SOLO para OWNER/PARTNER -->
      <mat-form-field
        appearance="outline"
        class="topbar-franchise"
        *ngIf="isOwnerPartner()"
      >
        <mat-label>Franquicia</mat-label>
        <mat-select
          [value]="activeFranchiseId()"
          (selectionChange)="onFranchiseChange($event.value)"
        >
          <mat-option *ngFor="let f of franchises" [value]="f.id">
            {{ franchiseLabel(f) }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <div class="who">
        <div class="name">{{ userName() }}</div>
        <div class="role">{{ role() }}</div>
      </div>

      <button mat-stroked-button class="logout" (click)="logout()">
        Salir
      </button>
    </div>

    <div class="page">
      <router-outlet></router-outlet>
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>
